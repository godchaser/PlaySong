@(user: UserAccount, userAccountForm: Form[UserAccount], userAccounts: List[UserAccount], message: String)

@admintheme("Admin", user){
<link rel="stylesheet" media="screen" href="@routes.Assets.at("lib/bootstrap-select/dist/css/bootstrap-select.min.css")">
<link rel="stylesheet" media="screen" href="@routes.Assets.at("lib/handsontable/handsontable.full.min.css")">

<div id="admin_wrapper">
	<h3>@message</h3>
	<div class="container">
		<div class="row">
			<div class="col-md-4">
				<h3>Users</h3>
				<ul>
					@userAccounts.map { userAccount =>
					<li>
						@userAccount.name, @userAccount.email
						<button class="deletebutton" type="button" id=@userAccount.email>
							<i class="fa fa-times"></i>
						</button>
					</li>
					}
				</ul>
			</div>
			<div class="col-md-4">
				<h3>Add new users</h3>
				@helper.form(action = routes.Application.addUser()) {
				@helper.inputText(userAccountForm("name"), args = '_label -> "User name: ")
				@helper.inputText(userAccountForm("email"), args = '_label -> "E-mail: ")
				@helper.inputText(userAccountForm("password"), args = '_label -> "Password: ")

				@if(userAccountForm.hasGlobalErrors) {
				<p class="error">
					@userAccountForm.globalError.message
				</p>
				}
				<input type="submit" value="Save">
				}
			</div>
		</div>
		<div>
			<h3>Upload updated xlsx file</h3>
			@helper.form(action = routes.Application.upload, 'enctype -> "multipart/form-data") {
			<input type="file" name="uploadedfile">
			<p>
				<input type="submit">
			</p>
			}
		</div>
		<div>
			<button type="button" id="downloadxlsx">
				Download xlsx dump
			</button>
		</div>
		<div id="songtable"></div>
	</div>
</div>

<script src="@routes.Assets.at("javascripts/jquery-2.1.3.min.js")" type="text/javascript"></script>
<script src="@routes.Assets.at("lib/handsontable/handsontable.full.min.js")" type="text/javascript"></script>
<script src="@routes.Application.javascriptRoutes()" type="text/javascript"></script>

<script type="text/javascript">
	$(document).ready(function() {
		$('#dynamiccontent').html($('#admin_wrapper').html());
		$('#admin_wrapper').remove();

		function deleteUser(email) {
			console.log("Delete user : " + email);
			jsRoutes.controllers.Application.deleteUser(email).ajax({
				type : 'DELETE',
				success : function() {
					var link = "@routes.Application.admin()";
					window.location = link;
				},
				error : function() {
					console.log("Error: ajax failure");
				}
			});
		}


		$('.deletebutton').click(function(event) {
			var email = this.id;
			deleteUser(email);
		});
		$('#downloadxlsx').click(function(event) {
			var link = "@routes.Application.getXLS()";
			window.location = link;
		});

		var container = document.getElementById('songtable');

		var data = function() {
			return Handsontable.helper.createSpreadsheetData(250, 5);
		};

		var hot = new Handsontable(container, {
			data : data(),
			height : 396,
			colHeaders : true,
			rowHeaders : true,
			stretchH : 'all',
			columnSorting : true,
			contextMenu : true
		});

	}); 
</script>
}
